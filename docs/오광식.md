## DAW

DAW(디지털 오디오 워크스테이션)

PC에서 제작할때는 C++가 일반적으로 실시간 오디오 처리를 위한 성능 면에서 선호
Android에서 Java 또는 Kotlin으로 개발하거나, 성능이 중요한 부분은 C++(NDK)를 활용해 AudioTrack, AudioRecord, 또는 Oboe 라이브러리 같은 저지연 오디오 API를 사용

휘슬허브에서는 Kotlin + Oboe 사용

## Oboe

- Android Studio & NDK:
  Android Studio를 설치하고, NDK(네이티브 개발 키트)를 설정해야 합니다. Oboe는 C++ 라이브러리이므로 NDK 환경이 필수입니다.

- Oboe 라이브러리 포함:
  Oboe를 프로젝트에 포함시키는 방법은 두 가지가 있습니다.

      - 소스 코드 포함: Oboe의 GitHub 저장소(Oboe GitHub)에서 소스 코드를 받아 서브모듈 또는 직접 복사해 프로젝트에 포함.

      - CMake 설정: CMakeLists.txt 파일에서 Oboe를 외부 라이브러리로 추가하여 빌드하도록 설정합니다.

- 최소 API 레벨:
  Oboe는 API 16 이상에서 동작하지만, 저지연 오디오 기능과 최신 기능 사용을 위해 API 21 이상을 권장합니다.

## 오디오 스트림 생성 및 설정

Oboe에서는 AudioStreamBuilder를 사용하여 오디오 스트림을 생성할 수 있습니다. 스트림을 생성할 때는 다음과 같은 주요 파라미터들을 설정합니다.

방향(Direction): 입력(Input) 또는 출력(Output) 스트림 선택
샘플레이트(Sample Rate): 예) 44100Hz 또는 48000Hz
채널 수(Channel Count): Mono, Stereo 등
포맷(Format): 오디오 데이터의 형식 (예: Float, PCM 16비트 등)
성능 모드(Performance Mode): 저지연(low-latency) 모드를 사용하여 실시간 처리를 최적화

```
#include <oboe/Oboe.h>

class AudioEngine : public oboe::AudioStreamCallback {
public:
    AudioEngine() {}

    // 오디오 스트림 생성 및 시작
    oboe::Result start() {
        oboe::AudioStreamBuilder builder;
        builder.setCallback(this)
               ->setDeviceId(oboe::kUnspecified)  // 기본 오디오 장치 사용
               ->setDirection(oboe::Direction::Output)
               ->setSampleRate(48000)             // 샘플레이트 설정
               ->setChannelCount(oboe::ChannelCount::Stereo)
               ->setFormat(oboe::AudioFormat::Float)
               ->setPerformanceMode(oboe::PerformanceMode::LowLatency);

        oboe::AudioStream* stream = nullptr;
        auto result = builder.openStream(&stream);
        if (result != oboe::Result::OK) {
            // 오류 처리: 스트림 생성 실패 시 적절한 처리를 수행
            return result;
        }
        mStream = stream;
        mStream->start();
        return oboe::Result::OK;
    }

    // AudioStreamCallback: 오디오 데이터 제공 함수
    oboe::DataCallbackResult onAudioReady(oboe::AudioStream *oboeStream,
                                            void *audioData,
                                            int32_t numFrames) override {
        // 예제에서는 각 프레임에 대해 무음을 출력합니다.
        float *floatData = static_cast<float *>(audioData);
        for (int i = 0; i < numFrames * 2; ++i) { // 스테레오이므로 2 채널
            floatData[i] = 0.0f;
        }
        return oboe::DataCallbackResult::Continue;
    }

    // 오디오 스트림 중지 및 종료
    void stop() {
        if (mStream) {
            mStream->stop();
            mStream->close();
            mStream = nullptr;
        }
    }

private:
    oboe::AudioStream *mStream = nullptr;
};

```
